{{/*
  Unified 1200×627 thumbnail frame for every post card.
  Renders the shared SVG chrome (background, "FRAME GRAPH" title)
  then delegates to a slug-specific inner partial for unique artwork.

  Params (dict):
    .slug           – post slug, doubles as SVG-ID namespace
    .subtitle       – second-line text, e.g. "THEORY"
    .subtitleColor  – fill colour for the subtitle
    .ariaLabel      – accessible label for the <svg>
*/}}
{{ $p  := . }}
{{ $id := $p.slug }}

{{/* ── Resolve any extra assets the inner partial may need ────── */}}
{{ $innerCtx := dict "id" $id }}

{{/* ── Image map: slug → asset path for the shared image panel ── */}}
{{ $imageMap := dict
  "frame-graph-build-it"   "images/BuildItCode.png"
  "frame-graph-production" "images/UnrealInsightRDG.png"
}}
{{ with index $imageMap $id }}
  {{ $url := . | relURL }}
  {{ with resources.Get . }}
    {{ $url = .RelPermalink }}
  {{ end }}
  {{ $innerCtx = merge $innerCtx (dict "imageURL" $url) }}
{{ end }}

{{/* ── Render inner content via slug-specific partial ─────────── */}}
{{ $innerName := printf "thumbnails/inner-%s.html" $id }}

<svg xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1200 540" width="1200" height="540"
     role="img" aria-label="{{ $p.ariaLabel }}"
     class="ds-thumbnail-svg">
  <defs>
    {{/* Background gradient – shared by all thumbnails */}}
    <linearGradient id="bg-{{ $id }}" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#0f1b33"/>
      <stop offset="100%" stop-color="#070c18"/>
    </linearGradient>
    {{/* 3-D panel gradients – used by most thumbnails */}}
    <linearGradient id="panelTop-{{ $id }}" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#213a62"/>
      <stop offset="100%" stop-color="#11233b"/>
    </linearGradient>
    <linearGradient id="panelSide-{{ $id }}" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#132740"/>
      <stop offset="100%" stop-color="#0a1526"/>
    </linearGradient>
    {{/* Drop-shadow filter */}}
    <filter id="softShadow-{{ $id }}" x="-20%" y="-20%" width="160%" height="180%">
      <feDropShadow dx="0" dy="18" stdDeviation="14" flood-color="#000" flood-opacity=".55"/>
    </filter>
  </defs>

  {{/* ── Shared frame: background and title ─────────────────── */}}
  <g transform="translate(0 0) scale(0.75)">
    <rect x="0" y="0" width="1600" height="720" rx="0" fill="url(#bg-{{ $id }})"/>

    <text x="54" y="96" fill="#f7faff"
          font-family="Inter,system-ui,sans-serif" font-size="64"
          font-weight="900" letter-spacing="1.2">FRAME GRAPH</text>

    <text x="54" y="166" fill="{{ $p.subtitleColor }}"
          font-family="Inter,system-ui,sans-serif" font-size="64"
          font-weight="900" letter-spacing="1.2">{{ $p.subtitle }}</text>

    <text x="1538" y="84" text-anchor="end" fill="#d5e0f5"
          font-family="Inter,system-ui,sans-serif" font-size="24"
          font-weight="700"></text>

    {{/* ── Per-post artwork ──────────────────────────────────── */}}
    {{ partial $innerName $innerCtx }}

  </g>
</svg>
