{{/*
  Unified 1200×627 thumbnail frame for every post card.
  Renders the shared SVG chrome (background, "FRAME GRAPH" title)
  then delegates to a slug-specific inner partial for unique artwork.

  Params (dict):
    .slug           – post slug, doubles as SVG-ID namespace
    .subtitle       – second-line text, e.g. "THEORY"
    .subtitleColor  – fill colour for the subtitle
    .ariaLabel      – accessible label for the <svg>
*/}}
{{ $p  := . }}
{{ $id := $p.slug }}

{{/* ── Resolve any extra assets the inner partial may need ────── */}}
{{ $innerCtx := dict "id" $id }}

{{/* ── Image map: slug → asset path for the shared image panel ── */}}
{{ $imageMap := dict
  "frame-graph-build-it"   "images/BuildItCode.png"
  "frame-graph-production" "images/UnrealInsightRDG.png"
}}
{{ with index $imageMap $id }}
  {{ $url := . | relURL }}
  {{ with resources.Get . }}
    {{ $url = .RelPermalink }}
  {{ end }}
  {{ $innerCtx = merge $innerCtx (dict "imageURL" $url) }}
{{ end }}

{{/* ── Render inner content via slug-specific partial ─────────── */}}
{{ $innerName := printf "thumbnails/inner-%s.html" $id }}

<svg xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 1200 540" width="1200" height="540"
     role="img" aria-label="{{ $p.ariaLabel }}"
     class="ds-thumbnail-svg">
  <defs>
    {{/* Background gradient – shared by all thumbnails */}}
    <linearGradient id="bg-{{ $id }}" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#0f1f3d"/>
      <stop offset="52%" stop-color="#0a172f"/>
      <stop offset="100%" stop-color="#0b0b0e"/>
    </linearGradient>
    <radialGradient id="bgGlow-{{ $id }}" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse"
                    gradientTransform="translate(240 80) rotate(25) scale(760 420)">
      <stop offset="0%" stop-color="{{ $p.subtitleColor }}" stop-opacity=".22"/>
      <stop offset="52%" stop-color="{{ $p.subtitleColor }}" stop-opacity=".06"/>
      <stop offset="100%" stop-color="{{ $p.subtitleColor }}" stop-opacity="0"/>
    </radialGradient>
    <linearGradient id="frameSheen-{{ $id }}" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#d6e8ff" stop-opacity=".14"/>
      <stop offset="12%" stop-color="#d6e8ff" stop-opacity=".03"/>
      <stop offset="100%" stop-color="#d6e8ff" stop-opacity="0"/>
    </linearGradient>
    <linearGradient id="headerFade-{{ $id }}" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#11294d" stop-opacity=".85"/>
      <stop offset="72%" stop-color="#11294d" stop-opacity=".16"/>
      <stop offset="100%" stop-color="#11294d" stop-opacity="0"/>
    </linearGradient>
    {{/* 3-D panel gradients – used by most thumbnails */}}
    <linearGradient id="panelTop-{{ $id }}" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#213a62"/>
      <stop offset="100%" stop-color="#11233b"/>
    </linearGradient>
    <linearGradient id="panelSide-{{ $id }}" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#132740"/>
      <stop offset="100%" stop-color="#0a1526"/>
    </linearGradient>
    {{/* Drop-shadow filter */}}
    <filter id="softShadow-{{ $id }}" x="-20%" y="-20%" width="160%" height="180%">
      <feDropShadow dx="0" dy="18" stdDeviation="14" flood-color="#000" flood-opacity=".55"/>
    </filter>
  </defs>

  {{/* ── Shared frame: background and title ─────────────────── */}}
  <g transform="translate(0 0) scale(0.75)">
    <rect x="0" y="0" width="1600" height="720" rx="0" fill="url(#bg-{{ $id }})"/>
      <rect x="0" y="0" width="1600" height="720" rx="0" fill="url(#bgGlow-{{ $id }})"/>
      <rect x="0" y="0" width="1600" height="720" rx="0" fill="url(#frameSheen-{{ $id }})"/>
      <rect x="0" y="0" width="950" height="112" rx="0" fill="url(#headerFade-{{ $id }})"/>

      <text x="54" y="84" fill="#f7faff"
        font-family="Inter,system-ui,sans-serif" font-size="56"
        font-weight="780" letter-spacing=".7">FRAME GRAPH</text>

      <text x="54" y="148" fill="{{ $p.subtitleColor }}"
        font-family="Inter,system-ui,sans-serif" font-size="58"
        font-weight="760" letter-spacing=".3">{{ $p.subtitle }}</text>

      <line x1="54" y1="206" x2="900" y2="206" stroke="#7ea0d2" stroke-opacity=".22" stroke-width="2"/>
      <line x1="54" y1="206" x2="240" y2="206" stroke="{{ $p.subtitleColor }}" stroke-opacity=".58" stroke-width="2"/>

    {{/* ── Per-post artwork ──────────────────────────────────── */}}
    {{ partial $innerName $innerCtx }}

  </g>
</svg>
